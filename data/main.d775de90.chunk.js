(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,t,a){e.exports=a(48)},34:function(e,t,a){},36:function(e,t,a){},48:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(8),o=a.n(l),i=(a(34),a(35),a(19)),c=a(9),s=a(26),u=a(10),d=a(11),h=a(14),m=a(12),f=a(15),E=a(64),g=a(55),p=a(65),v=a(66),b=a(67),k=a(68),y=a(53),w=a(56),O=a(57),C=(a(36),a(49)),S=a(50),j=a(51),x=a(52),N=function(e){return r.a.createElement("header",null,r.a.createElement(C.a,{color:"light",light:!0,expand:"md"},r.a.createElement(S.a,{href:"/"},"LEDanager"),r.a.createElement(j.a,{navbar:!0},r.a.createElement(x.a,null,r.a.createElement(y.a,{onClick:function(){return e.toggleModal()}},"Update")))))},T=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},I={effects:{name:{disabled:!0,type:"text"},speed:{type:"range",min:0,max:255},scale:{type:"range",min:0,max:100},brightness:{type:"range",min:0,max:255}},alarms:{time:{type:"time"},color:{type:"text"},enabled:{type:"checkbox"}}},A=a(54),H=a(58),F=a(59),W=function(e){var t,a,n=e.data,l=e.handleChange,o=e.activeEffect,i=e.setActiveEffect;return r.a.createElement("div",null,r.a.createElement(w.a,null,r.a.createElement(O.a,null,r.a.createElement("h3",{className:"mt-1"},"Effects"))),r.a.createElement(w.a,null,r.a.createElement(O.a,{md:"5",className:"order-sm-1"},r.a.createElement(H.a,{style:{overflow:"auto",height:"300px"}},n.map(function(e,t){return r.a.createElement(F.a,{key:e.name,active:t===o,onClick:function(){return i(t)}},e.name)}))),r.a.createElement(O.a,{md:"7",className:"order-sm-0"},(t=n[o],a=o,Object.keys(I.effects).map(function(e,n){var o=I.effects[e];return r.a.createElement("p",{key:e},r.a.createElement(A.a,null,T(e),":\xa0",r.a.createElement("span",{className:"text-secondary"},t[e])),r.a.createElement(g.a,Object.assign({placeholder:T(e),name:"effects."+e,value:t[e],"data-index":a,onChange:l.bind(void 0)},o)))})))))},_=a(28),L=window.ENV_HTTP_HOST?window.ENV_HTTP_HOST:"http://localhost:8000",P=window.ENV_WEBSOCKET_HOST?window.ENV_WEBSOCKET_HOST:"localhost:8000",U=Object(_.w3cwebsocket)("ws://".concat(P,"/")),M=function(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(e.statusText))};var B=function(e){return fetch("".concat(L,"/updateSize"),{method:"POST",body:new URLSearchParams("fileSize=".concat(e))}).then(M)},G=function(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;return new Promise(function(n,r){var l=new XMLHttpRequest;for(var o in l.open(t.method||"get",e),t.headers||{})l.setRequestHeader(o,t.headers[o]);l.onload=function(e){return n(e.target.responseText)},l.onerror=r,l.upload&&a&&(l.upload.onprogress=a),l.send(t.body)})}("".concat(L,"/update"),{method:"POST",body:e},t)},R=a(69),V=a(60),z=a(61),D=a(62),J=a(63),K=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).onChangeHandler=function(e){a.setState({selectedFile:e.target.files[0]})},a.changeUploadProgress=function(e){a.setState({loaded:e.loaded/e.total*100})},a.uploadFile=function(){a.setState({loaded:0,buttonsEnabled:!1}),B(a.state.selectedFile.size).then(function(){return G(a.state.selectedFile,a.changeUploadProgress).then(function(){return setTimeout(function(){return a.props.toggle()},2e3)})})},a.state={selectedFile:null,loaded:null,buttonsEnabled:!0},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isOpen,a=e.toggle;return r.a.createElement(R.a,{isOpen:t,toggle:a.bind(this),unmountOnClose:!0},r.a.createElement(V.a,{toggle:a.bind(this)},"Upload new firmware"),r.a.createElement(z.a,null,null==this.state.loaded?r.a.createElement(g.a,{type:"file",id:"modalInputField",onChange:this.onChangeHandler.bind(this)}):r.a.createElement(D.a,{value:this.state.loaded},this.state.loaded,"%")),r.a.createElement(J.a,null,r.a.createElement(y.a,{disabled:!this.state.buttonsEnabled,color:"primary",onClick:this.uploadFile.bind(this)},"Upload")," ",r.a.createElement(y.a,{disabled:!this.state.buttonsEnabled,color:"secondary",onClick:a.bind(this)},"Cancel")))}}]),t}(r.a.Component),q={effects:"EFFECTS_CHANGED",alarms:"ALARMS_CHANGED",working:"WORKING",activeEffect:"ACTIVE_EFFECT"},X=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={effects:[],alarms:[],working:null,activeEffect:null,modalIsOpen:!1},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"initWebSocket",value:function(){var e=this;U.onopen=function(){console.log("WebSocket connection opened")},U.onmessage=function(t){var a=JSON.parse(t.data);e.setState(Object(s.a)({},a))}}},{key:"sendEvent",value:function(e,t){U.send(JSON.stringify({event:e,data:t}))}},{key:"toggleModal",value:function(){this.setState(function(e){return{modalIsOpen:!e.modalIsOpen}})}},{key:"changeWorking",value:function(){var e=this;this.setState(function(t){return e.sendEvent(q.working,!t.working),{working:!t.working}})}},{key:"setActiveEffect",value:function(e){var t=this;this.setState(function(a){return t.sendEvent(q.activeEffect,e),{activeEffect:e}})}},{key:"onUpdateItem",value:function(e,t,a,n){var r=this;this.setState(function(l){var o=l[e].map(function(l,o){return o===t&&(l[a]=n,r.sendEvent(q[e],l)),l});return Object(c.a)({},e,o)})}},{key:"handleListChange",value:function(e){var t=e.target.name.split("."),a=Object(i.a)(t,2),n=a[0],r=a[1],l=e.target.value,o=parseInt(e.target.getAttribute("data-index"));this.onUpdateItem(n,o,r,l)}},{key:"handleListCheckBox",value:function(e){var t=e.target.name.split("."),a=Object(i.a)(t,2),n=a[0],r=a[1],l=e.target.checked,o=parseInt(e.target.getAttribute("data-index"));this.onUpdateItem(n,o,r,l)}},{key:"componentWillMount",value:function(){this.initWebSocket()}},{key:"renderInput",value:function(e,t,a,n){var l=I[n][t];return"checkbox"===l.type?r.a.createElement(E.a,{key:t},r.a.createElement(g.a,Object.assign({placeholder:T(t),name:n+"."+t,checked:e[t],"data-index":a,onChange:this.handleListCheckBox.bind(this),addon:!0},l))):r.a.createElement(g.a,Object.assign({key:t,placeholder:T(t),name:n+"."+t,value:e[t],"data-index":a,onChange:this.handleListChange.bind(this)},l))}},{key:"renderGroup",value:function(e){var t=this;return r.a.createElement(p.a,null,r.a.createElement(v.a,null,r.a.createElement("h2",{className:"mt-2"},T(e)),this.state[e].map(function(a,n){return r.a.createElement(b.a,{key:n,className:"mt-1"},Object.keys(I[e]).map(function(r,l){return t.renderInput(a,r,n,e)}))})))}},{key:"renderEffects",value:function(){return r.a.createElement(W,{data:this.state.effects,handleChange:this.handleListChange.bind(this),activeEffect:this.state.activeEffect,setActiveEffect:this.setActiveEffect.bind(this)})}},{key:"renderAlarms",value:function(){return this.renderGroup("alarms")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"wrapper"},r.a.createElement(k.a,null,this.state.modalIsOpen&&r.a.createElement(K,{isOpen:this.state.modalIsOpen,toggle:this.toggleModal.bind(this)}),r.a.createElement(N,{toggleModal:this.toggleModal.bind(this)}),r.a.createElement("h1",{className:"mt-2"},"LED ",this.state.working?"working":"not working",r.a.createElement(y.a,{color:"primary",className:"float-right",onClick:function(){return e.changeWorking()},active:this.state.working,size:"lg"},this.state.working?"Turn Off":"Turn On")),r.a.createElement(w.a,null,r.a.createElement(O.a,null,0!==this.state.effects.length?this.renderEffects():r.a.createElement("p",null,"No data to display"),0!==this.state.alarms.length?this.renderAlarms():r.a.createElement("p",null,"No data to display")))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[29,1,2]]]);
//# sourceMappingURL=main.d775de90.chunk.js.map